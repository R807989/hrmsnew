pipeline {
agent any 

    environment {
        PATH = "/path/to/pyenv/bin:${env.PATH}"
        SHELL = '/bin/bash' // or '/bin/sh' depending on your shell
    }







stages{


stage("intigration"){

steps{
git branch: 'main', url: 'https://github.com/R807989/hrmsnew.git'

}

}


  

 
           stage('Set Up Python') {
            steps {
                script {
                    // Install dependencies using Pipenv
                    sh 'pipenv install --dev'
                }
            }
        }

 

 stage('Build Docker Image') {
            steps {
        dir("/var/lib/jenkins/workspace/python/HRMS-Server") {

                script {
                    // Build Docker image
                   
sh 'docker build -t python .'
                }
            }
        }
}
stage('Run Docker Container') {
    steps {
        script {
            // Run Docker container
            def exitCode = sh(script: 'docker run --name my-python-container -d -p 8003:8000 python', returnStatus: true)
            if (exitCode != 0) {
                error "Failed to start Docker container. Exit code: ${exitCode}"
            }

            // Print container logs for debugging
            sh 'docker logs my-python-container'
        }
    }
}




}
}

